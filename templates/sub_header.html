{% load static %}

<div id="sticky-bar">
  <header class="subheader">
    <div class="container container--narrow">
      <nav class="subheader__nav">
        <ul>
          <li class="subheader__menuItem" id="goldspot">Gold&nbsp;<span>${{gold_price}}</span></li>
          <li class="subheader__menuItem" id="silverspot">Silver&nbsp;<span>${{silver_price}}</span></li>
          <li class="subheader__menuItem" id="platinumspot">Platinum&nbsp;<span>${{platinum_price}}</span></li>
          <a><li class="subheader__menuItem"><span class="solar--refresh-square-broken" id="update-metals-data-button"></span></li></a>
        </ul>
      </nav>
    </div>
  </header>
</div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    $(document).ready(function() {
        $('#update-metals-data-button').click(function() {
            $.ajax({
                url: "{% url 'updateMetalsData' %}",
                type: "GET",
                success: function(response){
                    console.log(response);
                    $('#goldspot').html(`Gold&nbsp;<span>$${parseFloat(response.gold_price).toFixed(2)}</span>`);
                    $('#silverspot').html(`Silver&nbsp;<span>$${parseFloat(response.silver_price).toFixed(2)}</span>`);
                    $('#platinumspot').html(`Platinum&nbsp;<span>$${parseFloat(response.platinum_price).toFixed(2)}</span>`);
                },
                error: function() {
                    alert('An error occurred.');
                }
            });
        });
    });
</script>